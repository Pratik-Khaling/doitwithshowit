document.addEventListener('DOMContentLoaded',function(){console.log("intial application scrl grow loaded");if(!window.animatedClasses)window.animatedClasses=[];if(!window.animatedClasses.includes('scr-grow'))window.animatedClasses.push('scr-grow');function clamp(val,min,max){return Math.max(min,Math.min(max,val));}function getExistingTransform(el){const currentTransform=el.style.transform||'';const translateMatch=currentTransform.match(/translate\([^)]+\)/);const translate=translateMatch?translateMatch[0]:'';return translate;}function parseScaleClass(el){const scaleClass=Array.from(el.classList).find(cls=>cls.startsWith('scale-'));if(scaleClass){const[start,end]=scaleClass.replace('scale-','').split('-').map(val=>parseFloat(val)/100);return{scaleStart:start||1,scaleEnd:end||1};}return{scaleStart:1,scaleEnd:1};}function applyInitialScale(el){const{scaleStart}=parseScaleClass(el);const translate=getExistingTransform(el);el.style.transform=`scale(${scaleStart},${scaleStart}) ${translate}`;el.style.transition='transform 0.1s ease-out';const imgChild=el.querySelector('.se-img');const textChild=el.querySelector('.se-t');if(imgChild){imgChild.style.transform=`scale(${scaleStart},${scaleStart})`;imgChild.style.transition='transform 0.1s ease-out';}if(textChild){textChild.style.transform=`scale(${scaleStart},${scaleStart})`;textChild.style.transition='transform 0.1s ease-out';}}function handleScrollScale(el){const{scaleStart,scaleEnd}=parseScaleClass(el);const rect=el.getBoundingClientRect();const windowHeight=window.innerHeight||document.documentElement.clientHeight;const elementHeight=rect.height;const progress=clamp(1-rect.bottom/(windowHeight+elementHeight),0,1);const scale=scaleStart+(scaleEnd-scaleStart)*progress;const translate=getExistingTransform(el);el.style.transform=`scale(${scale},${scale}) ${translate}`;el.style.transition='transform 0.1s ease-out';const imgChild=el.querySelector('.se-img');const textChild=el.querySelector('.se-t');if(imgChild){imgChild.style.transform=`scale(${scale},${scale})`;imgChild.style.transition='transform 0.1s ease-out';}if(textChild){textChild.style.transform=`scale(${scale},${scale})`;textChild.style.transition='transform 0.1s ease-out';}}function enableScrollGrow(el){if(!el._originalTransform){el._originalTransform=el.style.transform||'';}handleScrollScale(el);const onScroll=()=>handleScrollScale(el);if(el._scrGrowHandler){window.removeEventListener('scroll',el._scrGrowHandler);window.removeEventListener('resize',el._scrGrowHandler);}el._scrGrowHandler=onScroll;window.addEventListener('scroll',onScroll,{passive:true});window.addEventListener('resize',onScroll);}const options={root:null,rootMargin:'0px',threshold:0.2};const scrGrowObserver=new IntersectionObserver((entries)=>{entries.forEach((entry)=>{if(entry.isIntersecting){enableScrollGrow(entry.target);}});},options);const scrGrowElements=document.querySelectorAll('.scr-grow');scrGrowElements.forEach((el)=>{applyInitialScale(el);scrGrowObserver.observe(el);});const originalHandleIntersect=window.handleIntersect;window.handleIntersect=(entries,observer)=>{if(typeof originalHandleIntersect==='function'){originalHandleIntersect(entries,observer);}entries.forEach((entry)=>{if(entry.isIntersecting&&entry.target.classList.contains('scr-grow')){enableScrollGrow(entry.target);}});};});
